@model List<Gitar.Domain.Models.GitUser>

<button class="btn btn-success w-100" id="new-github-user"> <i class="fa-solid fa-user-plus"></i> &nbsp; Add new GitHub user </button>
<br />
<br />

<div class="d-flex flex-row flex-wrap align-items-center justify-content-center gap-lg-5">
    @foreach(var user in Model)
    {
        <div class="card shadow-lg" style="width: 400px">
            @{
                var imageUrl = string.IsNullOrEmpty(user.ImageUrl) ? "/assets/gitcat.png" : user.ImageUrl;
            }
            <img class="card-img-top" src="@imageUrl" alt="Github user">
            <div class="card-body">
                <h5 class="card-title"> @user.Name </h5>
            </div>
            <div class="card-footer">
                <small class="text-muted"> Last modified @user.ModifyDate.ToString("dd.MM.yyyy") at @user.ModifyDate.ToString("HH:mm")</small> <br />
                <small class="text-muted"> Created @user.CreateDate.ToString("dd.MM.yyyy") at @user.CreateDate.ToString("HH:mm")</small>
                <hr />
                <div class="d-flex flex-row justify-content-start gap-1" style="margin-bottom: 10px">
                    <button class="btn btn-sm btn-outline-danger user-delete-btn" data-id="@user.Id">
                        <i class="fa-solid fa-ban"></i> &nbsp; Delete
                    </button>
                    <button class="btn btn-sm btn-outline-success" data-id="@user.Id">
                        <i class="fa-regular fa-pen-to-square"></i> &nbsp; Modify
                    </button>
                    <button class="btn btn-sm btn-success" style="margin-left: auto !important" data-username="@user.Name">
                        <i class="fa-solid fa-code"></i> &nbsp; Repositories
                    </button>
                </div>                
            </div>
        </div>
    }
</div>

<script>
    $('.user-delete-btn').click(function() {
        Swal.fire({
            title: 'Warning',
            text: 'This action will delete selected user. Are you sure?',
            showCancelButton: true,
            icon: 'warning',
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'No'
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire('Saved!', '', 'success')
            }
        });
    });

    $('#new-github-user').click(function(){
        $.get('/Gitar/GetUpsertForm', function(content, responseText, response){
            if (response.status === 200) {
                var $modalHolder = $('#modal-holder');

                var $modalBody = $modalHolder.find('.modal-body');
                var $modalTitle = $modalHolder.find('#modal-title');

                $modalTitle.html("Edit or create new github user");

                $modalBody.html(content);

                $modalHolder.modal('show');
            }
        })
    });
</script>